(function(t){function e(e){for(var n,r,i=e[0],c=e[1],l=e[2],b=0,d=[];b<i.length;b++)r=i[b],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&d.push(s[r][0]),s[r]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);u&&u(e);while(d.length)d.shift()();return o.push.apply(o,l||[]),a()}function a(){for(var t,e=0;e<o.length;e++){for(var a=o[e],n=!0,i=1;i<a.length;i++){var c=a[i];0!==s[c]&&(n=!1)}n&&(o.splice(e--,1),t=r(r.s=a[0]))}return t}var n={},s={app:0},o=[];function r(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=n,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(a,n,function(e){return t[e]}.bind(null,n));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="Vue-warsaw-app/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var l=0;l<i.length;l++)e(i[l]);var u=c;o.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"25a1":function(t,e,a){},"3c71":function(t,e,a){},"3ec8":function(t,e,a){"use strict";a("cf1f")},"4faf":function(t,e,a){"use strict";a("5eda")},"56d7":function(t,e,a){"use strict";a.r(e);var n=a("7a23"),s=a("5502"),o=(a("d9e2"),a("13d5"),{setStations(t,e){t.stations.push(e)},findStations(t,e){const a=t.stations;let n=e,s=null;e.match(/.+\s\d\d/g)&&(n=e.slice(0,e.length-3),s=e.slice(n.length+1,e.length));let o=a[0].filter(t=>t.values[2].value.toLowerCase()===n.toLowerCase()).map(t=>({id:t.values[0].value,number:t.values[1].value,name:t.values[2].value,streetId:t.values[3].value,lat:t.values[4].value,lng:t.values[5].value,direction:t.values[6].value,from:t.values[7].value}));if(null!==s&&(o=o.filter(t=>t.number===s)),0===o.length)throw new Error("Nie ma takiej ulicy");t.filteredStations=o},setTimetableArray(t,e){const a=e["result"].map(t=>t["values"][5]["value"]).map(t=>({hour:t.substr(0,2),minutes:t.substr(3,2)})).reduce((t,e)=>t[e.hour]?{...t,[e.hour]:[...t[e.hour],e.minutes]}:{...t,[e.hour]:[e.minutes]},{}),n=Object.keys(a).map(t=>({hour:t,minutes:a[t]})).sort((t,e)=>t.hour.localeCompare(e.hour));t.timetable=n}});const r="https://api.um.warszawa.pl/api/",i="action/dbstore_get/?id=ab75c33d-3a26-4342-b36a-6e5fef0a3ac3&sortBy=id&apikey=",c="action/busestrams_get/?resource_id=f2e5503e-927d-4ad3-9500-4ab9e55deb59&apikey=",l="c75e7626-71c8-4084-9f70-741f9a32a421";var u={base:r,allStops:i,vehicles:c,API:l},b={async loadStations(t){const e=await fetch(`${u.base}${u.allStops}${u.API}`);e.ok;const a=await e.json();t.commit("setStations",a.result)},findStations(t,e){t.commit("findStations",e)},async loadTimetable(t,e){const a=await fetch(`${u.base}action/dbtimetable_get/?id=e923fa0e-d96c-43f9-ae6e-60518c9f3238&busstopId=${e.id}&busstopNr=${e.number}&line=${e.line}&apikey=${u.API}`),n=await a.json();t.commit("setTimetableArray",n)}},d={stations(t){return t.stations},filteredStations(t){return t.filteredStations},hasTimetable(t){return null!==t.timetable&&t.timetable.length>0},timetable(t){return t.timetable}},p={namespaced:!0,state(){return{stations:[],filteredStations:[],timetable:null,busInfo:null}},mutations:o,actions:b,getters:d};const m=Object(s["a"])({modules:{transport:p},state(){}});var f=m;function h(t,e,a,s,o,r){const i=Object(n["q"])("the-map");return Object(n["k"])(),Object(n["c"])(i)}a("6cc5");const A={class:"map",ref:"map",id:"map"};function j(t,e,a,s,o,r){const i=Object(n["q"])("the-menu");return Object(n["k"])(),Object(n["e"])(n["a"],null,[Object(n["h"])(i,{onSetMarkers:r.addBusStopMarker,busStopInfo:r.busStopInfo},null,8,["onSetMarkers","busStopInfo"]),Object(n["f"])("div",A,null,512)],64)}var O=a("e11e"),v=a.n(O),g=a("733e"),k=a.n(g);const S=t=>(Object(n["m"])("data-v-2dea3ed6"),t=t(),Object(n["l"])(),t),y=S(()=>Object(n["f"])("h2",null,"Lista przystanków",-1)),w={class:"form-control"},I=S(()=>Object(n["f"])("label",{for:"busStop"},null,-1)),B={key:0,class:"error"},L=Object(n["g"])("Wyszukaj"),M={key:0,class:"stop-details"},P={class:"stop-details__lines"},z=["onClick"],Q={key:2,class:"timetable"},D={class:"timetable__time"},C={class:"hour"},R={key:3,class:"timetable"},E=S(()=>Object(n["f"])("h2",null,"Brak rozkładu jazdy",-1)),V=[E],q=S(()=>Object(n["f"])("span",null,null,-1)),G=S(()=>Object(n["f"])("span",null,null,-1)),N=S(()=>Object(n["f"])("span",null,null,-1)),F=[q,G,N];function T(t,e,a,s,o,r){const i=Object(n["q"])("base-button"),c=Object(n["q"])("base-spinner");return Object(n["k"])(),Object(n["e"])(n["a"],null,[Object(n["f"])("nav",{class:Object(n["j"])({active:o.isActive})},[Object(n["f"])("form",{onSubmit:e[1]||(e[1]=Object(n["w"])((...t)=>r.findStation&&r.findStation(...t),["prevent"]))},[y,Object(n["f"])("div",w,[I,o.streetError?(Object(n["k"])(),Object(n["e"])("p",B,Object(n["r"])(o.streetError),1)):Object(n["d"])("",!0),Object(n["v"])(Object(n["f"])("input",{placeholder:"Wyszukaj przystanek...",type:"text",name:"busStop",id:"busStop","onUpdate:modelValue":e[0]||(e[0]=t=>o.busStop=t)},null,512),[[n["s"],o.busStop,void 0,{trim:!0}]])]),Object(n["h"])(i,null,{default:Object(n["u"])(()=>[L]),_:1})],32),a.busStopInfo?(Object(n["k"])(),Object(n["e"])("div",M,[Object(n["f"])("h2",null,Object(n["r"])(a.busStopInfo.name)+" "+Object(n["r"])(a.busStopInfo.number),1),Object(n["f"])("div",P,[(Object(n["k"])(!0),Object(n["e"])(n["a"],null,Object(n["o"])(a.busStopInfo.lines,t=>(Object(n["k"])(),Object(n["e"])("button",{key:t,ref_for:!0,ref:t,onClick:e=>r.displayTimetable(t)},Object(n["r"])(t),9,z))),128))])])):Object(n["d"])("",!0),o.isLoading?(Object(n["k"])(),Object(n["c"])(c,{key:1})):r.hasTimetable&&!o.isLoading?(Object(n["k"])(),Object(n["e"])("div",Q,[Object(n["f"])("h2",null,"Rozkład jazdy dla "+Object(n["r"])(o.timetableLine),1),Object(n["f"])("div",D,[(Object(n["k"])(!0),Object(n["e"])(n["a"],null,Object(n["o"])(r.timetable,t=>(Object(n["k"])(),Object(n["e"])("div",{class:"time",key:t},[Object(n["f"])("span",C,Object(n["r"])(t.hour),1),(Object(n["k"])(!0),Object(n["e"])(n["a"],null,Object(n["o"])(t.minutes,t=>(Object(n["k"])(),Object(n["e"])("span",{class:"minutes",key:t},Object(n["r"])(t),1))),128))]))),128))])])):(Object(n["k"])(),Object(n["e"])("div",R,V))],2),Object(n["f"])("button",{onClick:e[2]||(e[2]=(...t)=>r.toggleNav&&r.toggleNav(...t)),class:Object(n["j"])(["hamburger",{active:o.isActive}]),re:""},F,2)],64)}var H={props:["busStopInfo"],emits:["set-markers"],data(){return{isActive:!1,busStop:"",activeNumber:null,timetableLine:null,isLoading:!1,streetError:null}},methods:{toggleNav(){this.isActive=!this.isActive},findStation(){try{this.$store.dispatch("transport/findStations",this.busStop),this.$emit("set-markers"),this.streetError=null}catch(t){this.streetError=t.message}},async displayTimetable(t){this.isLoading=!0,this.timetableLine=t,await this.$store.dispatch("transport/loadTimetable",{line:t,id:this.busStopInfo.id,number:this.busStopInfo.number}),this.isLoading=!1},async getVehicles(){fetch("https://api.um.warszawa.pl/api/action/busestrams_get/?resource_id=f2e5503e-927d-4ad3-9500-4ab9e55deb59&apikey=c75e7626-71c8-4084-9f70-741f9a32a421&type=1&line=507").then(t=>t.json()).then(t=>console.log(t))}},computed:{active(){return this.activeNumber},hasTimetable(){return this.$store.getters["transport/hasTimetable"]},timetable(){return this.$store.getters["transport/timetable"]}},mounted(){this.getVehicles()}},K=(a("b446"),a("6b0d")),W=a.n(K);const X=W()(H,[["render",T],["__scopeId","data-v-2dea3ed6"]]);var Y=X,U={components:{TheMenu:Y},data(){return{map:null,busStopMarkers:[],stopInfo:null}},methods:{initializeMap(){this.map=v.a.map(this.$refs.map,{zoomControl:!1,zoomAnimation:!1,fadeAnimation:!0,markerZoomAnimation:!0}).setView([52.22977,21.01178],12),v.a.control.zoom({position:"bottomright"}).addTo(this.map),v.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(this.map)},async getAllStops(){await this.$store.dispatch("transport/loadStations")},addBusStopMarker(){this.busStopMarkers.forEach(t=>{this.removeBusStopMarker(t)});const t=this.$store.getters["transport/filteredStations"];let e;t.forEach(async t=>{const[a,n]=await this.getLinesForMarker(t.id,t.number),s=v.a.icon({iconUrl:k.a,iconSize:[32,32]});"null"!=t.lat&&"null"!=t.lng&&(this.map.flyTo([t.lat,t.lng],17),e=v.a.marker([t.lat,t.lng],{icon:s}).addTo(this.map).bindPopup(`${t.name} ${t.number}, <br> ${n}`).on("click",()=>this.setBusInfo(t,a))),this.busStopMarkers.push(e)})},setBusInfo(t,e){this.stopInfo={lines:e,name:t.name,number:t.number,id:t.id}},async getLinesForMarker(t,e){const a=await fetch(`https://api.um.warszawa.pl/api/action/dbtimetable_get/?id=88cd555f-6f31-43ca-9de4-66c479ad5942&busstopId=${t}&busstopNr=${e}&apikey=${u.API}`),n=await a.json(),s=n.result.map(t=>t.values).map(t=>t[0].value),o=s.join(", ");return[s,o]},removeBusStopMarker(t){this.map.removeLayer(t)}},computed:{didFoundStations(){return this.$store.getters["transport/didFoundStations"]},foundStations(){return this.$store.getters["transport/foundStations"]},busStopInfo(){return this.stopInfo}},mounted(){this.initializeMap(),this.getAllStops()}};a("4faf");const x=W()(U,[["render",j],["__scopeId","data-v-25238088"]]);var Z=x,J={components:{TheMap:Z}};a("8d89");const _=W()(J,[["render",h]]);var $=_;function tt(t,e,a,s,o,r){return a.link?Object(n["d"])("",!0):(Object(n["k"])(),Object(n["e"])("button",{key:0,class:Object(n["j"])(a.mode)},[Object(n["p"])(t.$slots,"default",{},void 0,!0)],2))}var et={props:{mode:{type:String,required:!1,default:null},link:{type:Boolean,required:!1,default:!1},to:{type:String,required:!1,default:"/"}}};a("d5dc");const at=W()(et,[["render",tt],["__scopeId","data-v-18536f2c"]]);var nt=at;const st=t=>(Object(n["m"])("data-v-5147169a"),t=t(),Object(n["l"])(),t),ot={class:"spinner"},rt=st(()=>Object(n["f"])("div",{class:"lds-roller"},[Object(n["f"])("div"),Object(n["f"])("div"),Object(n["f"])("div"),Object(n["f"])("div"),Object(n["f"])("div"),Object(n["f"])("div"),Object(n["f"])("div"),Object(n["f"])("div")],-1)),it=[rt];function ct(t,e){return Object(n["k"])(),Object(n["e"])("div",ot,it)}a("3ec8");const lt={},ut=W()(lt,[["render",ct],["__scopeId","data-v-5147169a"]]);var bt=ut;const dt=Object(n["b"])($);dt.component("base-button",nt),dt.component("base-spinner",bt),dt.use(f),dt.mount("#app")},"5eda":function(t,e,a){},"733e":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAB2AAAAdgB+lymcgAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAjBSURBVHic7VtrbFTHFf7Ofeyud+2YgME8TGkSKZg0eJ30QWNR1YCE8S6QhqqilSAyKBVyo0RqKb+L8qcPhVTqD9IGSlSZKE2N7ARj7K0wdhFxlKCC7YTGoCiWwDamMi4G27t37+P0h71mH3ftnd27rqrw/ZszZ7455+y5M3PP3AUe4iG+0qCFmohra90G0QaWpAowryWg1CIqBACJeYKBETBfI6I+xev9mBobowthV14DwNXVnmhh4fMA9hDzFgAFGQ6dIuYOCzjpYv6A2tq0fNmYlwDwjh1ewzRftoh+QcDynLiAWxJwRPF6j1JjY9gpG2NwPACRYHCnBPwBwBqHqQck4BWltbXVSVLHAsDV1R69sPC3YH7Vrt8qLobp98Nctw5WWRm4pATs8UwbEQ6DRkchDQ1B/vxzyL29kMbH01hMDWpBwQGnssGRAHBNzWJdVVvB/N3kPrO8HHogAMPvByQpM0LThNLXB/XsWcj9/XYa3aph7KBQaCw3yx0IANfWLtUlqQvAUwny0lJoL74Io6IiJ36ltxfuhgbQ7dvJXVdVSaqmlpbRXPhzCgDv3Fmkm+Z5AN+KlxsbN0KrqwO73bnQz4I0De4TJ6B0dyd3faJ6vVuosXEiW+4Mc9Ieumm+iSTno9u3I3LggGPOAwC73YjU1yO6e3dy13f0qak/58KddQZEA4GXQHQsQbZrF6IvvDDnuM6NtXP2b7rYNme/q6kJrubmRCHRfteZM2/POTANssoA3rp1GYh+Fy8zNm6c13knEN21C0ZVVZJB/DrX1i7Nhi+rAOiq+hqAR2fnLy2FVleXDVVW0PbvBy9bFi9arMvyr7LhEn4EOBBYrhMNAPDEZJFDh2xXe0vXMXC8ASPtHYjeEduxXCWLsbxmCx57aS8kVU3pV3p64DlyJF6k6bL8uO/06WGReYQzIEpUjzjnzXXr0m51A8cbcOOdRmHnASA6OoYb7zRi4HiDbb9RWQlz7dp4kdtlGD8VnUcRUWaAdGBPvEwPBNLqj4Q6AADP/vENFD+9Tsiw8b6ruPyzX2Ik1IEn6vfb6kSDQRRcu/bAPqK9DLxGAGc6j1AG6IGAH8DjsbZVXAxj/fq0+tHR6V9e1HkAKK74RgKHHcyKCnBxcbzoiWgg8LTIPEIZQJK0mflBcM3KSkCWU/Tm2+pEEeNL2SJlGabfD+XChQQbAXyaKbdQBjBzwqHHLC8XGZ4XGInrAJBk43wQygAACbNZZWW2SrFfyqlMmOtwxKtXJwl4rb2mPcR2AaIEj7mkRGh4PmAtWZLQZqLVaVRtIRYA5qKEpseTTnPBwAWJVTYCitKo2kL0ERDVB+D8ojgPXCLKogehu/ENikQEhzsPCqcUhoROXaJrQAI5jWZWi/h63U/wvfZTeGz/Hkd1AUC6cydZlMcAMCfMJg0OZjRs9Y9/CKXQh7IfPe+oLgDQzZvJorxmwL/im2nqdSkY/Nv7MCYmMNh0xlFdAFBSbbia0cDYeBFlMF+Jb8o9PYBp2p4G4zFw4iQGTpzMaAoRXRgG5L6+2aZpAZM6G5kNnoboI/DPhMHj41DiDEhG7DyfCxb50x/t5b4+0Ez53LSAkQkdJlsfifALZYDK3KMT3UfcXquePQvjmWds9Z89+jqA1G0w3ckuU70YXDN3JKbFuD1pggFe5lWb5vYiEUIZQG1tGgGheJnc3w+lt1eExhHIV65Avn4dusUYmTRhWAxVpiFqaZkS4REuiDDz6WSZu6EBpOXt/jIFFInA09CAsG7h9n0DpjX9hqpKeF+YS3QA19Qs1hVlGEBC3duoqkKkvl6UThzM8Bw9isiFbvwnbM5WPgjAox73msXnWm6I0AlnwMx11KlkudLdnVquzgPUpibc6/wQY3HOA4BLoQFR54Esq8JkWW/ayV1NTXC99142lBlBbjmDOw2nMBG1UvpUCb/OhjP7i5FgsAeA367PqKqCtm+fY2+LFInA+tMx3D3/Idim2ueSaOprF0K+bLizersDAAZ+Q8C7tqTd3ZC/+ALa3r0wKiuznQIAIF2+jIm3/oLIcMrl6IP5FOlY2s55kHUG8OHDkn7pUg+A9FVRAOaTTyIaDML0++c9Mc7CMCD39kJrbsG9vrmP24pM2hp6rpC6DgudAGPI6XZY2759NzH/NRNdnvlAwigvh7VqFXjp0tliBoXDkEZHQTdvQu7vh3apB+P/HoOZQXHb55beWNHRfjBbH3K7HgdIDwY/ArAhFx4AYAYmdQvjETMjxwHALdP9sn+EFhGQuipmiJyux2cuIF5GDgZYDNyLWhieMDAWztx5EOBW6JVcnJ+hyR3RQOAEiPaJjNFMxoRmYcpgsN3SPg8KVOn6qs52oQqwHXLKgBhUt/sQgPTL9AwMa/rXHpkwcHvCwKRuZeW8DFhFkrQjG1uT4UgAqLn5Dtt9HcZA1GSMR0zcum9g+L6Ou2ET0Yzz3B4et/z7RzrOXs+JZAaOfieoBQLNmsk/0EwgaljQDM7tAbWBR6HBsq6QUO1/LjiSATGEo3RwLGwa4xET4Tw4r0pkFPqU7zvJ6WgAFp1r/dI3vTI7DgJQoODni1pbv3Sa13EMbd7WEY5am53k9KlSaEVn+zYnOQGHMyCGleeLtrpkGnGKz61II8tLioJO8cUjLwEgNJo+r+/bioScy0QyUdSnqBuosdF0wrZk5CUAALCkrWnQpWCrDMr+mEpgrxvBbAodGc+RL2IAWHn+7xd8BfKrlMVKQwQUKdLB0nOhc85bFjdPPsljuLVl29uTmlUnMqbILb9V2tF2IE8mzWLB/jM0tKnmg7DOOzPR9SnUtqIrlP7zMwexYAEAgKHqmu6wwc/NpeNV6OOVXaGU/x3kCwsaAAak4U3bPg3r1lN2/V6VPlvRGaoQ+c4vV+R1EUwGAdbKzvb1bkVK+YzNo1D/ipJHKhfS+RmbFh4MSLeqaz6ZMvibAOBR6LNVXSF/rsWN/zsMbdp2cXhT7cX/tR0P8RBfYfwXQV465AQIRr4AAAAASUVORK5CYII="},"75c3":function(t,e,a){},"8d89":function(t,e,a){"use strict";a("3c71")},b446:function(t,e,a){"use strict";a("25a1")},cf1f:function(t,e,a){},d5dc:function(t,e,a){"use strict";a("75c3")}});
//# sourceMappingURL=app.79b75a5c.js.map